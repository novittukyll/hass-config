---
icon_button:
  template:
    - base
  show_icon: true
  show_name: true
  show_state: false
  styles:
    grid:
      - grid-template-areas: |
          "i n"
      - grid-template-columns: min-content min-content
      - grid-template-rows: 1fr
      - justify-content: center
    icon:
      - width: 1.6rem
    img_cell:
      - width: 1.6rem
    name:
      - margin-left: 1rem
    card:
      - filter: |
          [[[ return variables.is_active ? 'drop-shadow(3px 3px 5px #00000050)' : 'opacity(30%)' ]]]
      - background-color: |
          [[[ return variables.is_active ? 'green' : 'rgba(255, 255, 255, 0.12)' ]]]
      - height: 4rem
      - padding: 0 1rem 0 1rem
      - border-radius: 1rem
      - width: 100%

button_hass_update:
  template:
    - icon_button
  name: Päivitä nyt
  entity: binary_sensor.notification_hass_update_available
  tap_action:
    action: |
      [[[ return variables.is_active ? 'call-service' : 'none' ]]]
    service: |
      [[[ return variables.is_active ? 'rest_command.hass_update' : undefined ]]]
    confirmation:
      text: |
        [[[ return `Haluatko varmasti päivittää Home Assistant versioon ${states['sensor.hass_version_latest'].state}?` ]]]

button_synology_reboot:
  template:
    - icon_button
  variables:
    is_active: true
  name: Uudelleenkäynnistä
  entity: button.synology_reboot
  tap_action:
    action: call-service
    service: button.press
    service_data:
      entity_id: button.synology_reboot
    confirmation:
      text: Haluatko varmasti käynnistää Synologyn uudelleen?

button_galaxy_tab_wake_up:
  template:
    - icon_button
  variables:
    is_active: true
  name: Herätä
  entity: automation.wake_up_galaxy_tab_a8
  tap_action:
    action: call-service
    service: automation.trigger
    service_data:
      entity_id: automation.wake_up_galaxy_tab_a8

button_vacuum:
  template:
    - icon_button
  entity: vacuum.roborock_s6_pure

button_vacuum_clean:
  template:
    - button_vacuum
  variables:
    is_active: |
      [[[ return entity.state === 'docked' ]]]
  name: Aloita
  tap_action:
    action: call-service
    service: vacuum.send_command
    service_data:
      entity_id: |
        [[[ return entity.entity_id ]]]
      command: app_segment_clean
      params: |
        [[[
          var rooms = []
          if (states['input_boolean.vacuum_clean_entrance'].state === 'on') {
            rooms.push(18)
          }

          if (states['input_boolean.vacuum_clean_kitchen'].state === 'on') {
            rooms.push(17)
          }

          if (states['input_boolean.vacuum_clean_living_room'].state === 'on') {
            rooms.push(19)
          }

          if (states['input_boolean.vacuum_clean_bedroom'].state === 'on') {
            rooms.push(20)
          }

          if (states['input_boolean.vacuum_clean_office'].state === 'on') {
            rooms.push(16)
          }

          if (states['input_boolean.vacuum_clean_otsos_room'].state === 'on') {
            rooms.push(23)
          }

          if (states['input_boolean.vacuum_clean_sisus_room'].state === 'on') {
            rooms.push(22)
          }

          return rooms
        ]]]

button_vacuum_start_stop:
  template:
    - button_vacuum
  variables:
    is_active: |
      [[[ return entity.state !== 'docked' ]]]
  icon: mdi:play-pause
  name: |
    [[[
      return entity.state === 'docked' || entity.state === 'paused' || entity.state === 'idle'
          ? 'Jatka'
          : 'Pysäytä';
    ]]]
  tap_action:
    action: call-service
    service: |
      [[[
        return entity.state === 'docked' || entity.state === 'paused'
            ? 'vacuum.start'
            : 'vacuum.pause';
      ]]]
    service_data:
      entity_id: |
        [[[ return entity.entity_id ]]]

button_vacuum_return_to_base:
  template:
    - button_vacuum
  variables:
    is_active: |
      [[[ return entity.state !== 'docked' ]]]
  icon: mdi:home
  name: Telakkaan
  tap_action:
    action: call-service
    service: vacuum.return_to_base
    service_data:
      entity_id: |
        [[[ return entity.entity_id ]]]

harmony_remote_button:
  template:
    - base_icon_button
  variables:
    command: false
    device: false
    is_active: false
  entity: remote.olohuone
  tap_action:
    action: call-service
    service: remote.send_command
    service_data: |
      [[[
        const data = {
          entity_id: entity.entity_id
        }

        if (variables.command) {
          data['command'] = variables.command
        }

        if (variables.device) {
          data['device'] = variables.device
        }

        return data
      ]]]
  styles:
    icon:
      - width: 2.5rem
      - color: var(--primary-text-color)
    card:
      - height: 4rem
      - width: 4rem
      - background-color: 'rgba(var(--primary-text-color-rgb), 0.1)'
      - overflow: visible
      - '-webkit-box-shadow': |
          [[[
            if (variables.is_active) {
              return '0 0 0.5rem 0.1rem yellow'
            } else {
              return 'none'
            }
          ]]]
      - box-shadow: |
          [[[
            if (variables.is_active) {
              return '0 0 0.5rem 0.1rem yellow'
            } else {
              return 'none'
            }
          ]]]
      - transition: all 2s ease

harmony_remote_button_empty:
  template:
    - harmony_remote_button
  tap_action:
    action: none
  show_icon: false
  styles:
    card:
      - background-color: transparent

harmony_remote_button_text:
  template:
    - harmony_remote_button
  show_icon: false
  show_name: true

harmony_remote_button_off:
  template:
    - harmony_remote_button
  icon: mdi:power
  tap_action:
    action: call-service
    service: remote.turn_off
    service_data:
      entity_id: |
        [[[ return entity.entity_id ]]]

harmony_remote_button_num:
  template:
    - harmony_remote_button
  variables:
    device: Samsung TV
    number: 0
  icon: |
    [[[ return `mdi:numeric-${variables.number}` ]]]
  tap_action:
    action: call-service
    service: remote.send_command
    service_data:
      entity_id: |
        [[[ return entity.entity_id ]]]
      command: |
        [[[ return variables.number ]]]
      device: |
        [[[ return variables.device ]]]

harmony_remote_button_activity:
  template:
    - harmony_remote_button
  variables:
    activity: false
  tap_action:
    action: call-service
    service: remote.turn_on
    service_data:
      entity_id: |
        [[[ return entity.entity_id ]]]
      activity: |
        [[[ return variables.activity ]]]

harmony_remote_button_set_source:
  template:
    - harmony_remote_button
  variables:
    source: false
  tap_action:
    action: call-service
    service: media_player.select_source
    service_data:
      entity_id: |
        [[[ return entity.entity_id ]]]
      source: |
        [[[ return variables.source ]]]