action: fire-dom-event
browser_mod:
  command: popup
  title: Koti
  style:
    $: |
      .mdc-dialog .mdc-dialog__surface {
        background-color: var(--primary-background-color) !important;
      }
  card:
    type: custom:mod-card
    card_mod:
      style: |
        ha-card {
          padding: 16px
        }
        ha-card.type-custom-mod-card {
          background-color: var(--primary-background-color);
        }
    card:
      type: vertical-stack
      cards:
        - type: custom:button-card
          template: card_title
          label: Tila
        - type: horizontal-stack
          cards:
            - type: custom:button-card
              template: card_generic_swap
              entity: input_select.home_state
              icon: mdi:home
              name: Tila
              styles:
                icon:
                  - color: |
                      [[[
                        var state = states['input_select.home_state'].state
                        if (state == 'Kotona') {
                          return 'var(--custom-icon-color)'
                        } else {
                          return 'var(--custom-icon-color-not-active)'
                        }
                      ]]]
            - type: custom:button-card
              template: card_generic_swap
              entity: input_select.sauna_state
              icon: mdi:shower
              name: Sauna
              styles:
                icon:
                  - color: |
                      [[[
                        var state = states['input_select.sauna_state'].state

                        if (state == 'Lämpenee') {
                          return 'yellow';
                        } else if (state == 'Lämmin') {
                          return 'red';
                        } else if (state == 'Jäähtyy') {
                          return '#00ccf5'
                        } else {
                          return 'var(--custom-icon-color-not-active)'
                        }
                      ]]]
        - type: horizontal-stack
          cards:
            - type: custom:button-card
              template: card_generic_swap
              entity: media_player.samsung_q90_series_65
              name: Olohuone TV
              styles:
                icon:
                  - color: var(--custom-icon-color)
            - type: custom:button-card
              template: card_generic_swap
              entity: sensor.nibe_heat_pump_state
              name: Maalämpö
              styles:
                icon:
                  - color: |
                      [[[
                        var color = 'var(--custom-icon-color)'
                        var state = states['sensor.nibe_heat_pump_state'].state

                        if (state == 'Lämmitys') {
                          color = 'red';
                        } else if (state == 'Joutilas') {
                          color = 'var(--custom-icon-color-not-active)'
                        }

                        return color;
                      ]]]
        - type: entities
          style: |
            ha-card {
              border-radius: 20px
            }
          entities:
            - input_boolean.on_vacation
            - switch.tplink_hs100_1
            - switch.tplink_hs110_1
        - type: custom:button-card
          template: card_title
          label: Sähkönkulutus
        - type: horizontal-stack
          cards:
            - type: custom:button-card
              template: card_generic_swap
              entity: sensor.mqtt_electricity_consumption_daily
              icon: mdi:power-plug
              name: "[[[ return states['sensor.mqtt_electricity_consumption_daily_updated'].state ]]]"
              styles:
                icon:
                  - color: |
                      [[[
                        var consumption = entity.state;
                        var color = 'red';
                        if (consumption > 40) {
                          return color;
                        } else if (consumption > 30) {
                          return 'yellow';
                        } else {
                          return 'green';
                        }
                      ]]]
            - type: custom:button-card
              template: card_generic_swap
              entity: sensor.mqtt_electricity_consumption_monthly
              icon: mdi:power-plug
              name: Kuukausi
              styles:
                icon:
                  - color: |
                      [[[
                        var consumption = entity.state;
                        var color = 'red';
                        if (consumption > 850) {
                          return color;
                        } else if (consumption > 650) {
                          return 'yellow';
                        } else {
                          return 'green';
                        }
                      ]]]
        - type: custom:button-card
          template: card_title
          label: Automaatiot
        - type: entities
          style: |
            ha-card {
              border-radius: 20px
            }
          entities:
            - automation.aloita_iltarutiinit
            - automation.start_go_to_sleep
            - automation.aloita_nukkumaanmeno_viikonloppuisin
            - automation.herata_arkisin
            - automation.hot_water_pump_on
            - automation.hot_water_pump_off